<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023 Learning Diary - 5&nbsp; Week 5: Google Earth Engine</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week6.html" rel="next">
<link href="./week4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5: Google Earth Engine</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023 Learning Diary</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week 1: Getting started with remote sensing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2: Portfolio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3: Corrections</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 4: Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5: Google Earth Engine</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6: Classification I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week7: Classification II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week8: Temperature</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="toc-section-number">5.1</span>  Summary</a>
  <ul class="collapse">
  <li><a href="#introduction-about-google-earth-engine" id="toc-introduction-about-google-earth-engine" class="nav-link" data-scroll-target="#introduction-about-google-earth-engine"><span class="toc-section-number">5.1.1</span>  Introduction about Google Earth Engine</a></li>
  <li><a href="#objects-in-gee" id="toc-objects-in-gee" class="nav-link" data-scroll-target="#objects-in-gee"><span class="toc-section-number">5.1.2</span>  Objects in GEE</a></li>
  <li><a href="#architecture-of-gee" id="toc-architecture-of-gee" class="nav-link" data-scroll-target="#architecture-of-gee"><span class="toc-section-number">5.1.3</span>  Architecture of GEE</a></li>
  <li><a href="#application-of-google-earth-engine" id="toc-application-of-google-earth-engine" class="nav-link" data-scroll-target="#application-of-google-earth-engine"><span class="toc-section-number">5.1.4</span>  Application of Google Earth Engine</a></li>
  <li><a href="#discussion-of-median-method" id="toc-discussion-of-median-method" class="nav-link" data-scroll-target="#discussion-of-median-method"><span class="toc-section-number">5.1.5</span>  Discussion of median method</a></li>
  <li><a href="#better-images" id="toc-better-images" class="nav-link" data-scroll-target="#better-images"><span class="toc-section-number">5.1.6</span>  Better images</a></li>
  <li><a href="#texture-measures" id="toc-texture-measures" class="nav-link" data-scroll-target="#texture-measures"><span class="toc-section-number">5.1.7</span>  Texture measures</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca"><span class="toc-section-number">5.1.8</span>  PCA</a></li>
  <li><a href="#band-math-ndvi" id="toc-band-math-ndvi" class="nav-link" data-scroll-target="#band-math-ndvi"><span class="toc-section-number">5.1.9</span>  Band math (NDVI)</a></li>
  </ul></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="toc-section-number">5.2</span>  Application</a>
  <ul class="collapse">
  <li><a href="#monitoring-of-wetlands" id="toc-monitoring-of-wetlands" class="nav-link" data-scroll-target="#monitoring-of-wetlands"><span class="toc-section-number">5.2.1</span>  Monitoring of wetlands</a></li>
  <li><a href="#forest-cover-change" id="toc-forest-cover-change" class="nav-link" data-scroll-target="#forest-cover-change"><span class="toc-section-number">5.2.2</span>  Forest cover change</a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="toc-section-number">5.3</span>  Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5: Google Earth Engine</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.1</span> Summary</h2>
<section id="introduction-about-google-earth-engine" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="introduction-about-google-earth-engine"><span class="header-section-number">5.1.1</span> Introduction about Google Earth Engine</h3>
<p>Google Earth Engine is a cloud-based platform for geospatial data analysis and visualization. It provides access to a vast repository of satellite imagery and geospatial data, as well as a powerful suite of tools for processing and analyzing this data.</p>
<p>The advantages of Earth Engine is scalability. The platform can handle extremely large datasets and perform complex analysis in near real-time, making it well suited for monitoring changes on a global scale. Earth Engine also offers an easy-to-use programming interface (use command-based programming, env: javascript), allowing users to write custom scripts and algorithms to perform specific analysis tasks.</p>
<p>Google Earth Engine is also widely used by government agencies, NGOs, and academic institutions for a variety of purposes, including environmental monitoring, natural resource management, and disaster response. The platform is free to use for non-commercial purposes, and access to its data and tools can be granted through a simple application process.</p>
<p>Here is the link for GEE guidance: https://developers.google.com/earth-engine/guides/objects_methods_overview</p>
</section>
<section id="objects-in-gee" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="objects-in-gee"><span class="header-section-number">5.1.2</span> Objects in GEE</h3>
<ul>
<li><p>Image: a fundamental raster data type</p></li>
<li><p>ImageCollection: a set of images</p></li>
<li><p>Geometry: a fundamental vector data type</p></li>
<li><p>Feature: a geometry with attributes</p></li>
<li><p>FeatureCollection: a set of feature</p></li>
<li><p>Reducer: compute statistics or perform aggregations</p></li>
<li><p>Join: combine databases (images or feature collections) based on keys</p></li>
<li><p>Array: an object for multi-dimensional analyses</p></li>
<li><p>Chart: an object for charting properties and spatiotemporal redfuctions</p></li>
</ul>
</section>
<section id="architecture-of-gee" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="architecture-of-gee"><span class="header-section-number">5.1.3</span> Architecture of GEE</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/architecture.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Architecture of GEE Source: <a href="https://www.researchgate.net/figure/A-simplified-Google-Earth-Engine-GEE-system-architecture-diagram-Source-Gorelick-et_fig1_340678446">Research gate</a></figcaption><p></p>
</figure>
</div>
<p>The manipulation languages for client are JavaScript and Python, and all the requests will be responded by REST API. It has a cluster which contains masters and servers, MapReduce is used to do batch processing job, there are three kinds of databases for storage.</p>
</section>
<section id="application-of-google-earth-engine" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="application-of-google-earth-engine"><span class="header-section-number">5.1.4</span> Application of Google Earth Engine</h3>
<p>Load map, point of interest: Changzhou city, Jiangsu Province [31.81, 119.97]</p>
<pre><code>var Changzhou = ee.FeatureCollection('users/giscodingmo/gadm41_CHN_2')
    .filter('NL_NAME_1 == "常州市"');

var oneimage_study_area_cloud = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')
.filterDate('2021-01-01', '2022-12-10')
.filterBounds(Changzhou)  // Intersecting ROI
.filter(ee.Filter.lt("CLOUD_COVER", 0.1));


// load the image
var image_120_38 = ee.Image('LANDSAT/LC08/C02/T1_L2/LC08_120038_20211004')

// add the image on the map
Map.addLayer(one_image, {bands: ["SR_B4", "SR_B3", "SR_B2"]}, "Landsat 8")</code></pre>
<p>Result:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/path.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">path and row</figcaption><p></p>
</figure>
</div>
</section>
<section id="discussion-of-median-method" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="discussion-of-median-method"><span class="header-section-number">5.1.5</span> Discussion of median method</h3>
<p>Initially, I use imageCollection.reduce() function (median method) to reduce the images:</p>
<pre><code>var median = oneimage_study_area_cloud.reduce(ee.Reducer.median());

// print the image info
print(median, "median")</code></pre>
<p>Median method is effective when the classification task is between those objects which have giant jump such as forest and non-forest area, water and non-water area.</p>
<p>If the gap is not obvious, it is difficult to use median method to integrate images. To improve the accuracy of the classification, an improved method is to add other quartiles to the median, e.g.&nbsp;25% quartile, 75% quartile. Another method is using seasonal median (spring, summer, fall, winter) to substitute single median, use a curve to fit the trend.</p>
<pre><code>// example of season medians
function seasonComposite(start) {
  var end = ee.Number(start).add(2)  
  // transfer the data type
  return collection
  .filter(ee.Filter.calendarRange(start, end, "month"))
  .median()
}

// call
var seasons = ee.List([1,4,7,10]).map(seasonComposite);
var composite = ee.ImageCollection(seasons).toBands();</code></pre>
</section>
<section id="better-images" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="better-images"><span class="header-section-number">5.1.6</span> Better images</h3>
<section id="true-color-image" class="level4" data-number="5.1.6.1">
<h4 data-number="5.1.6.1" class="anchored" data-anchor-id="true-color-image"><span class="header-section-number">5.1.6.1</span> True color image</h4>
<p>write a function for the surface reflectance rate and temperature adjustment in Landsat Collection 2</p>
<pre><code>// Applies scaling factors in Collection 2
function applyScaleFactors(image) {
  var opticalBands = image.select('SR_B.').multiply(0.0000275).add(-0.2);
  var thermalBands = image.select('ST_B.*').multiply(0.00341802).add(149.0);
  return image.addBands(opticalBands, null, true)
              .addBands(thermalBands, null, true);
}

// call our collection to the function and assign it to a new variable 
var oneimage_study_area_cloud_scale = oneimage_study_area_cloud.map(applyScaleFactors);

// apply the median reducer
var oneimage_study_area_cloud_scale_median = oneimage_study_area_cloud_scale.reduce(ee.Reducer.median());

print(oneimage_study_area_cloud_scale_median)


// set up some of the visualisation paramters 
var vis_params = {
  bands: ['SR_B4_median', 'SR_B3_median', 'SR_B2_median'],
  min: 0.0,
  max: 0.3,
};

// add a layer to the map
Map.addLayer(oneimage_study_area_cloud_scale_median, vis_params, 'True Color (432)');</code></pre>
<p>Result:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/vis_map.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">visualization by true color (432)</figcaption><p></p>
</figure>
</div>
</section>
<section id="clip-image" class="level4" data-number="5.1.6.2">
<h4 data-number="5.1.6.2" class="anchored" data-anchor-id="clip-image"><span class="header-section-number">5.1.6.2</span> Clip image</h4>
<pre><code>var clip = meanImage.clip(Changzhou)
  .select(['SR_B1', 'SR_B2', 'SR_B3', 'SR_B4', 'SR_B5', 'SR_B6', 'SR_B7']);

var vis_params3 = {
  bands: ['SR_B4', 'SR_B3', 'SR_B2'],
  min: 0,
  max: 0.3,
};

// map the layer
Map.addLayer(clip, vis_params3, 'clip');</code></pre>
<p>Result: the image boundary is followed by city boundary</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/city_boundary.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">city boundary clip image</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="texture-measures" class="level3" data-number="5.1.7">
<h3 data-number="5.1.7" class="anchored" data-anchor-id="texture-measures"><span class="header-section-number">5.1.7</span> Texture measures</h3>
<pre><code>// based on the clip generated before
var glcm = clip.select(['SR_B1', 'SR_B2', 'SR_B3', 'SR_B4', 'SR_B5', 'SR_B6', 'SR_B7'])
  .multiply(1000)
  .toUint16()
  .glcmTexture({size: 1})
  .select('SR_.._contrast|SR_.._diss')
  .addBands(clip);
  
// add to the map, but change the range values  
Map.addLayer(glcm, {min:15, max:650 }, 'glcm');</code></pre>
<p>Result:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/texture.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">texture adjustment</figcaption><p></p>
</figure>
</div>
</section>
<section id="pca" class="level3" data-number="5.1.8">
<h3 data-number="5.1.8" class="anchored" data-anchor-id="pca"><span class="header-section-number">5.1.8</span> PCA</h3>
<p>Principle component analysis code is here:</p>
<pre><code>var scale = 30;
var bandNames = glcm.bandNames();

// print(bandNames)

var region = Changzhou.geometry();
// Map.centerObject(region, 10);
// Map.addLayer(ee.Image().paint(region, 0, 2), {}, 'Region');

// print(region, "Changzhou_geometry")
// print(bandNames)

// mean center the data and SD strech the princapal components 
// and an SD stretch of the principal components.
var meanDict = glcm.reduceRegion({
    reducer: ee.Reducer.mean(),
    geometry: region,
    scale: scale,
    maxPixels: 1e9
});

var means = ee.Image.constant(meanDict.values(bandNames));
var centered = glcm.subtract(means);


// This helper function returns a list of new band names.
var getNewBandNames = function(prefix) {
  var seq = ee.List.sequence(1, bandNames.length());
  return seq.map(function(b) {
    return ee.String(prefix).cat(ee.Number(b).int());
  });
};


// This function accepts mean centered imagery, a scale and
// a region in which to perform the analysis.  It returns the
// Principal Components (PC) in the region as a new image.
var getPrincipalComponents = function(centered, scale, region) {
  // Collapse the bands of the image into a 1D array per pixel.
  var arrays = centered.toArray();

  // Compute the covariance of the bands within the region.
  var covar = arrays.reduceRegion({
    reducer: ee.Reducer.centeredCovariance(),
    geometry: region,
    scale: scale,
    maxPixels: 1e9
  });

  // Get the 'array' covariance result and cast to an array.
  // This represents the band-to-band covariance within the region.
  var covarArray = ee.Array(covar.get('array'));

  // Perform an eigen analysis and slice apart the values and vectors.
  var eigens = covarArray.eigen();

  // This is a P-length vector of Eigenvalues.
  var eigenValues = eigens.slice(1, 0, 1);
  // This is a PxP matrix with eigenvectors in rows.
  
  var eigenValuesList = eigenValues.toList().flatten()
  var total = eigenValuesList.reduce(ee.Reducer.sum())
  var percentageVariance = eigenValuesList.map(function(item) {
  return (ee.Number(item).divide(total)).multiply(100).format('%.2f')
    })
  
  print("percentageVariance", percentageVariance)  

  var eigenVectors = eigens.slice(1, 1);

  // Convert the array image to 2D arrays for matrix computations.
  var arrayImage = arrays.toArray(1);

  // Left multiply the image array by the matrix of eigenvectors.
  var principalComponents = ee.Image(eigenVectors).matrixMultiply(arrayImage);

  // Turn the square roots of the Eigenvalues into a P-band image.
  var sdImage = ee.Image(eigenValues.sqrt())
    .arrayProject([0]).arrayFlatten([getNewBandNames('sd')]);

  // Turn the PCs into a P-band image, normalized by SD.
  return principalComponents
    // Throw out an an unneeded dimension, [[]] -&gt; [].
    .arrayProject([0])
    // Make the one band array image a multi-band image, [] -&gt; image.
    .arrayFlatten([getNewBandNames('pc')])
    // Normalize the PCs by their SDs.
    .divide(sdImage);
};

// Get the PCs at the specified scale and in the specified region
var pcImage = getPrincipalComponents(centered, scale, region);

// Plot each PC as a new layer
for (var i = 0; i &lt; bandNames.length().getInfo(); i++) {
  var band = pcImage.bandNames().get(i).getInfo();
  Map.addLayer(pcImage.select([band]), {min: -2, max: 2}, band);
}</code></pre>
<p>Result: I got the pictures, the number is equal to the length of bandNames, in my case, the bandNames contains 21 elements.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/pcajs.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">example of PCA analysis</figcaption><p></p>
</figure>
</div>
<p>The first component can explain 63.68% of variance within the collection and the second component explains 26.66%, the third explains only 6.11%, therefore, I can just add pc1 and pc2 instead of the entire image, somethimes, pc3 can also be added to improve the accuracy, reaching 96.45%.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/percentage.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Percentage variables of PCA</figcaption><p></p>
</figure>
</div>
<pre><code>Map.addLayer(pcImage, {bands: ['pca3', 'pc2', 'pc1'], min: -2, max: 2}, 'PCA bands 1, 2 and 3');

Map.addLayer(pcImage, {bands: ['pc2', 'pc1'], min: -2, max: 2}, 'PCA bands 1, 2');</code></pre>
<p>Comparison between 2 components and 3 components:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/pca12.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">2 components</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/pca123.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">3 components</figcaption><p></p>
</figure>
</div>
<p>Export image to drive</p>
<pre><code>var PCA_out = pcImage.select(['pc1', 'pc2', 'pc3'])

var projection = PCA_out.select('pc1').projection().getInfo();

var bounds = Changzhou.geometry();

// Export the image, specifying the CRS, transform, and region.
Export.image.toDrive({
  image: PCA_out,
  description: 'PCA_Changzhou',
  scale:30,
  crs: projection.crs,
  maxPixels: 100E10,
  region: bounds
});</code></pre>
</section>
<section id="band-math-ndvi" class="level3" data-number="5.1.9">
<h3 data-number="5.1.9" class="anchored" data-anchor-id="band-math-ndvi"><span class="header-section-number">5.1.9</span> Band math (NDVI)</h3>
<p>Calculate the NDVI quickly, use blue to identify the water area, green to identify the forest or vegetation area and white to identify the town, city</p>
<pre><code>//NDVI
var NDVI_1 = clip.select('SR_B5').subtract(clip.select('SR_B4'))
  .divide(clip.select('SR_5').add(clip.select('SR_B4')));

Map.addLayer(NDVI_1, { min: -1, max: 1, palette: ['blue', 'white', 'green']}, 'NDVI');</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/NDVI1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">NDVI</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="application" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="application"><span class="header-section-number">5.2</span> Application</h2>
<section id="monitoring-of-wetlands" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="monitoring-of-wetlands"><span class="header-section-number">5.2.1</span> Monitoring of wetlands</h3>
<p>Mahdianpari et al.&nbsp;assessed 30 years of change in Newfoundland wetlands using Landsat imagery, spectral indices and random forest classification within the Google Earth Engine (GEE) cloud computing platform.</p>
<p>Overall accuracy was high, ranging from 84.37% to 88.96%. In a comparison of different classifiers, random forest produced the highest accuracy results and allowed for the estimation of variable importance when comparing classification to regression trees (CART) and minimum distances (MD).</p>
<p>The most important variables included thermal infrared (TIR), elevation, difference vegetation index (DVI), shortwave infrared (SWIR) and normalised difference vegetation index (NDVI). The change detection analysis showed that bog, marsh and swamp were the most common wetland categories for all time periods and that boggy wetlands were the most common wetland type for all time periods. The analysis also revealed a general instability of wetland categories, although this was mainly due to transitions from one wetland category to another.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/method.jpeg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">General research methods of study. Source: <a href="https://www.tandfonline.com/doi/full/10.1080/15481603.2020.1846948">A large-scale change monitoring of wetlands using time series Landsat imagery on Google Earth Engine</a></figcaption><p></p>
</figure>
</div>
<p>The result of different land cover classification <img src="docs/image/classes.jpg" class="img-fluid" alt="Classification result"></p>
</section>
<section id="forest-cover-change" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="forest-cover-change"><span class="header-section-number">5.2.2</span> Forest cover change</h3>
<p>Hansen et al.&nbsp;(2013) studied the change of forest cover in global area. The studied published in 2013 that used satellite data to map global forest loss and gain from 2000 to 2012123. The paper reported that the tropics had the highest forest loss and the lowest forest gain, while subtropical forests had the highest rates of forest change due to intensive forestry.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/tree.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Global forest cover change. Source<a href="https://www.researchgate.net/publication/258529161_High-Resolution_Global_Maps_of_21st-Century_Forest_Cover_Change">High-Resolution Global Maps of 21st-Century Forest Cover Change</a></figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/typical area.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">4 typical area forest gain and loss. Source<a href="https://www.researchgate.net/publication/258529161_High-Resolution_Global_Maps_of_21st-Century_Forest_Cover_Change">High-Resolution Global Maps of 21st-Century Forest Cover Change</a></figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="reflection" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">5.3</span> Reflection</h2>
<p>In this week, I learned knowledge in several aspects: how to use Google Earth Engine to create points and analyse the ROI assisted with GADM boundary map.</p>
<ul>
<li><p>understood the advantages and disadvantages of using median methods to get the reduced images (advantages: fast calculation, be suitable for those objects which has giant difference; disadvantages: not accurate, can not reflect the trend of change) and knew the alternative and more accurate methods (multiple quantile methods: using 10% quantile, 25% quantile, 75% quantile, seasonal medians methods: using four medians to represent 4 seasons)</p></li>
<li><p>create true color image, mosaic image, clip image and do the texture adjustment by glcm</p></li>
<li><p>principle component analysis and find the explainable percentage, calculated NDVI and export them to local</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 4: Policy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week6.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6: Classification I</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>