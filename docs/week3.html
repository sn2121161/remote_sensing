<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023 Learning Diary - 3&nbsp; Week 3: Corrections</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week4.html" rel="next">
<link href="./week2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3: Corrections</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023 Learning Diary</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week 1: Getting started with remote sensing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2: Portfolio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3: Corrections</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 4: Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5: Google Earth Engine</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6: Classification I</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week7: Classification II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week8: Temperature</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="toc-section-number">3.1</span>  Summary</a>
  <ul class="collapse">
  <li><a href="#how-does-landsat-work-to-get-imagery" id="toc-how-does-landsat-work-to-get-imagery" class="nav-link" data-scroll-target="#how-does-landsat-work-to-get-imagery"><span class="toc-section-number">3.1.1</span>  How does Landsat work to get imagery</a></li>
  <li><a href="#geometric-correction" id="toc-geometric-correction" class="nav-link" data-scroll-target="#geometric-correction"><span class="toc-section-number">3.1.2</span>  Geometric correction</a></li>
  <li><a href="#atmospheric-correction" id="toc-atmospheric-correction" class="nav-link" data-scroll-target="#atmospheric-correction"><span class="toc-section-number">3.1.3</span>  Atmospheric correction</a></li>
  <li><a href="#orthorectification-correction" id="toc-orthorectification-correction" class="nav-link" data-scroll-target="#orthorectification-correction"><span class="toc-section-number">3.1.4</span>  Orthorectification correction</a></li>
  <li><a href="#radiometric-calibration" id="toc-radiometric-calibration" class="nav-link" data-scroll-target="#radiometric-calibration"><span class="toc-section-number">3.1.5</span>  Radiometric calibration</a></li>
  </ul></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="toc-section-number">3.2</span>  Application</a>
  <ul class="collapse">
  <li><a href="#image-enhancement" id="toc-image-enhancement" class="nav-link" data-scroll-target="#image-enhancement"><span class="toc-section-number">3.2.1</span>  Image enhancement</a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="toc-section-number">3.3</span>  Reflection</a>
  <ul class="collapse">
  <li><a href="#dos-and-radiance" id="toc-dos-and-radiance" class="nav-link" data-scroll-target="#dos-and-radiance"><span class="toc-section-number">3.3.1</span>  DOS and radiance</a></li>
  <li><a href="#index-calculation" id="toc-index-calculation" class="nav-link" data-scroll-target="#index-calculation"><span class="toc-section-number">3.3.2</span>  Index calculation</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca"><span class="toc-section-number">3.3.3</span>  PCA</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3: Corrections</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This week I learned something about the corrections, it can be divided into four aspects, geometric correction, atmospheric correction, orthorectification correction and radiometric calibration.</p>
<section id="summary" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">3.1</span> Summary</h2>
<section id="how-does-landsat-work-to-get-imagery" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="how-does-landsat-work-to-get-imagery"><span class="header-section-number">3.1.1</span> How does Landsat work to get imagery</h3>
<p>Landsat satellites use scanners to acquire images of the Earth’s surface in different spectral bands.</p>
<p>Landsat 1-6: use a sensor called the Multispectral Scanner (MSS), which scanned six lines simultaneously in each of the four spectral bands (green, red, near-infrared and mid-infrared) for each mirror sweep. The MSS sensor had a spatial resolution of about 80 meters and covered an area of about 34,000 square kilometers per image.</p>
<p>Landsat 7 and 8: The MSS sensor was replaced by more advanced sensors on later Landsat satellites, such as the Thematic Mapper (TM), Enhanced Thematic Mapper Plus (ETM+), Operational Land Imager (OLI) and Thermal Infrared Sensor (TIRS), which have higher spatial resolution, more spectral bands and better radiometric accuracy.</p>
</section>
<section id="geometric-correction" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="geometric-correction"><span class="header-section-number">3.1.2</span> Geometric correction</h3>
<p>Why we need geometric corrections:</p>
<ul>
<li>The satellite has view angles when watching the Earth</li>
<li>The undulating nature of the terrain (topography)</li>
<li>Wind</li>
<li>Rotation of Earth</li>
</ul>
<p>Workflow of geometric correction:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/workflow.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Workflow. Source: <a href="http://sar.kangwon.ac.kr/etc/rs_note/rsnote/cp9/cp9-4.htm">Geometric Correction</a></figcaption><p></p>
</figure>
</div>
<p>Methods of geometric correction</p>
<ul>
<li><p>systematic correction the geometry of a lens camera is given by the collinearity equation with calibrated focal length, parameters of lens distortions, coordinates of fiducial marks. The tangent correction for an optical mechanical scanner is a type of system correction.</p></li>
<li><p>Non-systematic correction Polynomials to transform from a geographic coordinate system to an image coordinate system, or vice versa, will be determined with given coordinates of ground control points using the least square method. The accuracy depends on the order of the polynomials, and the number and distribution of ground control points.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/9-4-2.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Non-systematic correction Source: <a href="http://sar.kangwon.ac.kr/etc/rs_note/rsnote/cp9/cp9-4.htm">Geometric Correction</a></figcaption><p></p>
</figure>
</div>
<ul>
<li>Combined method Firstly the systematic correction is applied, then the residual errors will be reduced using lower order polynomials. This method is used to obtain accurate images with less error.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/9-4-3.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Combined method Source: <a href="http://sar.kangwon.ac.kr/etc/rs_note/rsnote/cp9/cp9-4.htm">Geometric Correction</a></figcaption><p></p>
</figure>
</div>
</section>
<section id="atmospheric-correction" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="atmospheric-correction"><span class="header-section-number">3.1.3</span> Atmospheric correction</h3>
<p>Why we need atmospheric correction:</p>
<ul>
<li><p>Reduce the effect from path radiance and the haze created by absorption</p></li>
<li><p>To calculate the biophysical parameters (e.g.&nbsp;temperature, NDVI)</p></li>
</ul>
<p>The methods to do the atmospheric correction:</p>
<ul>
<li><p>Dark object subtraction (DOS), search the darkest value of image and subtract that from each pixel</p></li>
<li><p>Psuedo-invariant features (PIFs) use the linear function to adjust the image</p></li>
<li><p>ACORN, FLAASH, QUAC, ATCOR</p></li>
</ul>
</section>
<section id="orthorectification-correction" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="orthorectification-correction"><span class="header-section-number">3.1.4</span> Orthorectification correction</h3>
<p>Why we need orthorectification correction:</p>
<ul>
<li><p>Provide the coordinates to an image</p></li>
<li><p>Remove the distortions, make pixel viewed at straight down</p></li>
</ul>
<p>The methods to do the orthorectification correction:</p>
<ul>
<li><p>Consider the solar zenith angle and solar azimuth angle to do the cosine correction</p></li>
<li><p>The software we can use QGIS, R packages like RStoolbox</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/correction.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Example of orthorectification correction. Source: <a href="https://www.esri.com/about/newsroom/insider/what-is-orthorectified-imagery/">calibration from an inclination of 25 degrees to orthographic</a></figcaption><p></p>
</figure>
</div>
</section>
<section id="radiometric-calibration" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="radiometric-calibration"><span class="header-section-number">3.1.5</span> Radiometric calibration</h3>
<p>Why we need radiometric calibration:</p>
<ul>
<li>Convert the digital number sensors captured from the image brightness (without units) to spectral radiance (with units)</li>
</ul>
<p>Methods to do the radiometric calibration:</p>
<ul>
<li>Use converting function</li>
</ul>
</section>
</section>
<section id="application" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="application"><span class="header-section-number">3.2</span> Application</h2>
<section id="image-enhancement" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="image-enhancement"><span class="header-section-number">3.2.1</span> Image enhancement</h3>
<p>Muhammad Irfan Khan and Muhammad Sharifi compared different remote sensing image enhancement methods based on histogram correction techniques (HE, AGCWD) and transform domain methods (DWT-SVD, ACSEA, RHE-DCT, BF, HIM and SDF). The resulting images were compared visually and quantitatively. It is finally concluded that histogram modification-based methods are better if a higher proportion of detail is present in the image or if the image has a lower resolution, while transform domain methods have better performance for images with a low proportion of detail.</p>
<p>Compared object 1: <img src="docs/image/F1.png" class="img-fluid" alt="Tank image. Source: Image Enhancement Methods for Remote Sensing: A Survey"></p>
<p>Compared object 2: <img src="docs/image/F2.png" class="img-fluid" alt="Aerial image taken by air vehicle. Source: Image Enhancement Methods for Remote Sensing: A Survey"></p>
<p>Compared object 3: <img src="docs/image/F3.png" class="img-fluid" alt="Aerial image of an area containing harbor and airport. Source: Image Enhancement Methods for Remote Sensing: A Survey"></p>
<p>The red boxes are the input images for comparison, and the images from b to i correspond to the different image enhancement methods (b: AGCWD, c: DWT-SVD, d: RHE-DCT, e: ACSEA, f: BF, g: HIM, h: SDF, i: BF-HIM)</p>
<p>Visually, the BF-HIM hybrid method retains colours closer to the reality and enhances edge information better than the previous methods.</p>
<p>quantitatively, they also give a comprehensive comparison between several methods in 4 indicators, as a result, the hybrid BF-HIM performs better other methods:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/c1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">CG value</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/c2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">EME value</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/c3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">DE value</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/c4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">AMBE value</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="reflection" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">3.3</span> Reflection</h2>
<p>Here are several interested points after doing pieces of work</p>
<section id="dos-and-radiance" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="dos-and-radiance"><span class="header-section-number">3.3.1</span> DOS and radiance</h3>
<p>I used the remote sensing image (LC08_L1TP_119038_20230104_20230111_02_T1.txt downloaded from USGS EarthExplorer) to calculate the pixel value of surface reflections generated from scattering by DOS:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/l8_boa.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">l8_boa_ref</figcaption><p></p>
</figure>
</div>
<p>There are several methods to execute the atmosphereic corrections (from digital number to reflectance), two typical examples are DOS and converting radiance to reflectance. In this case, the difference between radiance to reflectance and DOS correction is not significant and both can be corrected accurately. Actually, When the atmosphere is thinner or when the weather is good, the influence of the atmosphere on the ground radiation is less, the TOA and BOA are close to each other, a small part of the light reaches the sensor through the path radiance, so the less dark object needs to be substracted, the effect is close to the radiance. On the contrary, the more pixels need to be corrected the more obvious the effect of the corrected image is compared to the pre-correction image.</p>
</section>
<section id="index-calculation" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="index-calculation"><span class="header-section-number">3.3.2</span> Index calculation</h3>
<p>Calculate the NDVI (Normalized Difference Vegetation Index) in my case.</p>
<p><span class="math inline">\(NDVI = (Band4 - Band5) / (Band4 + Band5)\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/m1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">result of m1_NDVI</figcaption><p></p>
</figure>
</div>
<p>The highlight area of healthy vegetation: <img src="docs/image/veg.png" class="img-fluid" alt="area of vegetation"></p>
<p>Explanation: from this map, the vegetation in the Taihu Lake basin is more concentrated to the west of the lake, where the most vegetation is found and where there is less population, while the area north of the lake to the south of the Yangtze River is less vegetated due to the high level of urbanisation, while the area north of the Yangtze River is relatively more vegetated.</p>
<p>Calculate the NDMI (Normalized Difference Moisture Index) Use band 5 and band 6 on the occasion of Landsat8:</p>
<p><span class="math inline">\(NDMI = (Band5 - Band6) / (Band5 + Band6)\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/NDMI.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">result of m1_NDMI</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/moi.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">result of moi</figcaption><p></p>
</figure>
</div>
</section>
<section id="pca" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="pca"><span class="header-section-number">3.3.3</span> PCA</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/image/pca.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">result of pca (m1_raster, glcm.red)</figcaption><p></p>
</figure>
</div>
<p>It can be seen that in my study area, the component 1 accounts for 54.20%, and the summary of component 1 to component 3 accounts for over 90%, component 1 can explain the 54.2% data from entire dataset.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2: Portfolio</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 4: Policy</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>